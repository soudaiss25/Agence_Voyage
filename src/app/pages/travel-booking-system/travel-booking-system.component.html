<!-- PAGE 1: PREFERENCES -->
<div *ngIf="currentPage === 'preferences'" class="container-fluid min-vh-100" style="background: linear-gradient(135deg, #0d6efd 0%)">
  <div class="container py-5">
    <div class="row justify-content-center">
      <div class="col-lg-8">
        <div class="text-center text-white mb-5">
        
          <p class="lead">Dites-nous vos pr√©f√©rences et nous vous proposerons le voyage parfait</p>
        </div>

        <div class="card shadow-lg border-0" style="border-radius: 20px">
          <div class="card-body p-5">
            <div class="row g-4">
              <!-- Climat -->
              <div class="col-md-6">
                <label class="form-label fw-bold text-dark mb-3">
                   Climat pr√©f√©r√©
                </label>
                <div class="d-grid gap-2">
                  <div *ngFor="let climate of climateOptions" class="form-check">
                    <input 
                      class="form-check-input" 
                      type="radio" 
                      name="climate" 
                      [id]="climate"
                      [value]="climate"
                      (change)="onClimateChange(climate)"
                    />
                    <label class="form-check-label" [for]="climate">{{climate}}</label>
                  </div>
                </div>
              </div>

              <!-- Zone -->
              <div class="col-md-6">
                <label class="form-label fw-bold text-dark mb-3">
                   Zone g√©ographique
                </label>
                <div class="d-grid gap-2">
                  <div *ngFor="let zone of zoneOptions" class="form-check">
                    <input 
                      class="form-check-input" 
                      type="radio" 
                      name="zone" 
                      [id]="zone"
                      [value]="zone"
                      (change)="onZoneChange(zone)"
                    />
                    <label class="form-check-label" [for]="zone">{{zone}}</label>
                  </div>
                </div>
              </div>

              <!-- Langue -->
              <div class="col-md-6">
                <label class="form-label fw-bold text-dark mb-3">
                   Langue parl√©e
                </label>
                <select 
                  class="form-select"
                  [(ngModel)]="preferences.language"
                  (change)="onLanguageChange(preferences.language)"
                >
                  <option value="">Choisir une langue</option>
                  <option *ngFor="let lang of languageOptions" [value]="lang.value">
                    {{lang.label}}
                  </option>
                </select>
              </div>

              <!-- Budget -->
              <div class="col-md-6">
                <label class="form-label fw-bold text-dark mb-3">
                   Budget
                </label>
                <select 
                  class="form-select"
                  [(ngModel)]="preferences.budget"
                  (change)="onBudgetChange(preferences.budget)"
                >
                  <option value="">Choisir un budget</option>
                  <option *ngFor="let budget of budgetOptions" [value]="budget.value">
                    {{budget.label}}
                  </option>
                </select>
              </div>

              <!-- Dur√©e -->
              <div class="col-12">
                <label class="form-label fw-bold text-dark mb-3">
                   Dur√©e du voyage
                </label>
                <div class="row">
                  <div *ngFor="let duration of durationOptions" class="col-6 col-md-3">
                    <div class="form-check">
                      <input 
                        class="form-check-input" 
                        type="radio" 
                        name="duration" 
                        [id]="duration"
                        [value]="duration"
                        (change)="onDurationChange(duration)"
                      />
                      <label class="form-check-label" [for]="duration">{{duration}}</label>
                    </div>
                  </div>
                </div>
              </div>

              <!-- Activit√©s -->
              <div class="col-12">
                <label class="form-label fw-bold text-dark mb-3">
                   Activit√©s pr√©f√©r√©es
                </label>
                <div class="row">
                  <div *ngFor="let activity of activityOptions" class="col-6 col-md-4">
                    <div class="form-check">
                      <input 
                        class="form-check-input" 
                        type="checkbox" 
                        [id]="activity"
                        [checked]="isActivitySelected(activity)"
                        (change)="onActivityToggle(activity)"
                      />
                      <label class="form-check-label" [for]="activity">{{activity}}</label>
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <div class="text-center mt-5">
              <button 
                class="btn btn-lg px-5 py-3 text-white fw-bold"
                style="background-color: #0d6efd; border-radius: 50px; border: none; box-shadow: 0 8px 25px rgba(13, 110, 253, 0.3)"
                (click)="goToRecommendations()"
              >
                Voir mes recommandations
                ‚û§
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- PAGE 2: RECOMMENDATIONS -->
<div *ngIf="currentPage === 'recommendations'" class="container-fluid min-vh-100" style="background-color: #f8f9ff">
  <div class="container py-5">
    <div class="text-center mb-5">
      <h1 class="display-4 fw-bold mb-3" style="color: #0d6efd">
        üéØ Nos Recommandations Pour Vous
      </h1>
      <p class="lead text-muted">Bas√©es sur vos pr√©f√©rences personnalis√©es</p>
    </div>

    <div class="row g-4">
      <div *ngFor="let trip of recommendations" class="col-lg-4 col-md-6">
        <div [ngClass]="getCardClass()" style="border-radius: 20px; overflow: hidden">
          <!-- Header avec emoji -->
          <div class="card-header text-center p-4" style="background-color: #0d6efd; color: white">
            <div style="font-size: 4rem">{{trip.image_placeholder}}</div>
            <h4 class="fw-bold mb-0">{{trip.destination}}</h4>
          </div>

          <div class="card-body p-4">
            <div class="d-flex justify-content-between align-items-center mb-3">
              <span class="badge bg-success px-3 py-2">{{trip.climate}}</span>
              <div class="d-flex align-items-center">
                <span *ngFor="let star of getStarArray(trip.rating)" class="text-warning">‚≠ê</span>
                <span class="fw-bold ms-1">{{trip.rating}}</span>
              </div>
            </div>

            <p class="text-muted mb-3">{{trip.description}}</p>

            <div class="mb-3">
              <h6 class="fw-bold mb-2">Points forts :</h6>
              <div class="row g-1">
                <div *ngFor="let highlight of trip.highlights" class="col-6">
                  <small class="d-flex align-items-center">
                    ‚úÖ {{highlight}}
                  </small>
                </div>
              </div>
            </div>

            <div class="row text-center mb-3">
              <div class="col-6">
                <div class="border-end">
                  <h5 class="fw-bold mb-0" style="color: #0d6efd">{{trip.price}}</h5>
                  <small class="text-muted">Prix total</small>
                </div>
              </div>
              <div class="col-6">
                <h5 class="fw-bold mb-0" style="color: #0d6efd">{{trip.duration}}</h5>
                <small class="text-muted">Dur√©e</small>
              </div>
            </div>
          </div>

          <div class="card-footer bg-transparent p-4">
            <div class="d-grid gap-2">
              <button 
                class="btn text-white fw-bold py-3"
                style="background-color: #0d6efd; border-radius: 15px; border: none"
                (click)="goToValidation(trip)"
              >
                Choisir ce voyage
              </button>
              <button class="btn btn-outline-secondary" (click)="addToFavorites(trip)">
                ‚ù§Ô∏è Ajouter aux favoris
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="text-center mt-5">
      <button 
        class="btn btn-outline-primary btn-lg px-4"
        (click)="goToPreferences()"
      >
        ‚Üê Modifier mes pr√©f√©rences
      </button>
    </div>
  </div>
</div>

<!-- PAGE 3: VALIDATION -->
<div *ngIf="currentPage === 'validation'" class="container-fluid min-vh-100" style="background: linear-gradient(135deg, #0d6efd )">
  <div class="container py-5">
    <div class="row justify-content-center">
      <div class="col-lg-10">
        <div class="text-center text-white mb-5">
          <h1 class="display-4 fw-bold mb-3"> Finaliser Votre R√©servation</h1>
          <p class="lead">Plus qu'une √©tape pour concr√©tiser votre voyage de r√™ve !</p>
        </div>

        <div class="row g-4">
          <!-- R√©capitulatif du voyage -->
          <div class="col-lg-4">
            <div class="card shadow-lg border-0 h-100" style="border-radius: 20px">
              <div class="card-header text-center p-4" style="background-color: #0d6efd; color: white; border-radius: 20px 20px 0 0">
                <h4 class="fw-bold mb-0">R√©capitulatif</h4>
              </div>
              <div class="card-body p-4" *ngIf="selectedTrip">
                <div class="text-center mb-4">
                  <div style="font-size: 3rem">{{selectedTrip.image_placeholder}}</div>
                  <h5 class="fw-bold">{{selectedTrip.destination}}</h5>
                </div>
                
                <div class="mb-3">
                  <div class="d-flex justify-content-between">
                    <span>Destination :</span>
                    <strong>{{selectedTrip.destination}}</strong>
                  </div>
                </div>
                
                <div class="mb-3">
                  <div class="d-flex justify-content-between">
                    <span>Dur√©e :</span>
                    <strong>{{selectedTrip.duration}}</strong>
                  </div>
                </div>
                
                <div class="mb-3">
                  <div class="d-flex justify-content-between">
                    <span>Prix par personne :</span>
                    <strong>{{selectedTrip.price}}</strong>
                  </div>
                </div>

                <div class="mb-3">
                  <div class="d-flex justify-content-between">
                    <span>Nombre de voyageurs :</span>
                    <strong>{{bookingData.travelers}}</strong>
                  </div>
                </div>
                
                <hr/>
                
                <div class="d-flex justify-content-between">
                  <span class="fw-bold">Total :</span>
                  <strong style="color: #0d6efd; font-size: 1.2rem">{{calculateTotalPrice()}}</strong>
                </div>
              </div>
            </div>
          </div>

          <!-- Formulaire de r√©servation -->
          <div class="col-lg-8">
            <div class="card shadow-lg border-0" style="border-radius: 20px">
              <div class="card-body p-5">
                <h4 class="fw-bold mb-4" style="color: #0d6efd">
                   Informations de r√©servation
                </h4>

                <div class="row g-3">
                  <div class="col-md-6">
                    <label class="form-label fw-bold">Pr√©nom *</label>
                    <input 
                      type="text" 
                      class="form-control form-control-lg"
                      [(ngModel)]="bookingData.firstName"
                    />
                  </div>
                  <div class="col-md-6">
                    <label class="form-label fw-bold">Nom *</label>
                    <input 
                      type="text" 
                      class="form-control form-control-lg"
                      [(ngModel)]="bookingData.lastName"
                    />
                  </div>
                  <div class="col-md-6">
                    <label class="form-label fw-bold">
                       Email *
                    </label>
                    <input 
                      type="email" 
                      class="form-control form-control-lg"
                      [(ngModel)]="bookingData.email"
                    />
                  </div>
                  <div class="col-md-6">
                    <label class="form-label fw-bold">
                       T√©l√©phone *
                    </label>
                    <input 
                      type="tel" 
                      class="form-control form-control-lg"
                      [(ngModel)]="bookingData.phone"
                    />
                  </div>
                  <div class="col-md-6">
                    <label class="form-label fw-bold">Nombre de voyageurs</label>
                    <select 
                      class="form-select form-select-lg"
                      [(ngModel)]="bookingData.travelers"
                    >
                      <option *ngFor="let num of travelerOptions" [value]="num">
                        {{num}} personne{{num > 1 ? 's' : ''}}
                      </option>
                    </select>
                  </div>
                  <div class="col-md-6">
                    <label class="form-label fw-bold">
                       Date de d√©part souhait√©e
                    </label>
                    <input 
                      type="date" 
                      class="form-control form-control-lg"
                      [(ngModel)]="bookingData.departureDate"
                    />
                  </div>
                  <div class="col-12">
                    <label class="form-label fw-bold">Demandes sp√©ciales (optionnel)</label>
                    <textarea 
                      class="form-control" 
                      rows="3"
                      placeholder="Anniversaire, r√©gime alimentaire, accessibilit√©..."
                      [(ngModel)]="bookingData.specialRequests"
                    ></textarea>
                  </div>
                </div>

                <div class="mt-4 p-3 bg-light rounded">
                  <div class="form-check">
                    <input class="form-check-input" type="checkbox" id="terms"/>
                    <label class="form-check-label" for="terms">
                      J'accepte les <a href="#" style="color: #0d6efd">conditions g√©n√©rales</a> et la <a href="#" style="color: #0d6efd">politique de confidentialit√©</a>
                    </label>
                  </div>
                </div>

                <div class="d-grid gap-3 mt-4">
                  <button 
                    class="btn btn-lg text-white fw-bold py-3"
                    style="background-color: #28a745; border-radius: 15px; border: none; box-shadow: 0 8px 25px rgba(40, 167, 69, 0.3)"
                    [disabled]="!isBookingFormValid()"
                    (click)="onSubmitBooking()"
                  >
                    Proc√©der au paiement
                  </button>
                  <button 
                    class="btn btn-outline-primary btn-lg"
                    (click)="currentPage = 'recommendations'"
                  >
                    ‚Üê Retour aux recommandations
                  </button>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>